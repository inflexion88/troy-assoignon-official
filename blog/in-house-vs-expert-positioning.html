<!DOCTYPE html>
<html lang="en" class="dark">
  <head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-74JF9CHYSL"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){window.dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-74JF9CHYSL', {
        'send_page_view': true
      });
      gtag('config', 'G-EJX2GZ9H1N');
    </script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- SEO Meta Tags -->
    <title>In-House Positioning vs. Expert-Led: The Complete ROI Analysis [2025] | Troy Assoignon</title>
    <meta name="description" content="Compare in-house positioning vs. expert-led approaches with complete ROI analysis. Discover true costs, timelines, and when each delivers maximum value." />
    <meta name="author" content="Troy Assoignon" />

    <!-- Canonical Tag -->
    <link rel="canonical" href="https://www.troyassoignon.com/blog/in-house-vs-expert-positioning" />

    <!-- Open Graph Tags -->
    <meta property="og:title" content="In-House Positioning vs. Expert-Led: The Complete ROI Analysis [2025] | Troy Assoignon" />
    <meta property="og:description" content="Compare in-house positioning vs. expert-led approaches with complete ROI analysis. Discover true costs, timelines, and when each delivers maximum value." />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://www.troyassoignon.com/blog/in-house-vs-expert-positioning" />
    <meta property="og:image" content="https://www.troyassoignon.com/og-image.png" />
    <meta property="og:site_name" content="Troy Assoignon - Positioning Expert" />

    <!-- Twitter Card Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="In-House Positioning vs. Expert-Led: The Complete ROI Analysis [2025]" />
    <meta name="twitter:description" content="Compare in-house positioning vs. expert-led approaches with complete ROI analysis. Discover true costs, timelines, and when each delivers maximum value." />
    <meta name="twitter:image" content="https://www.troyassoignon.com/og-image.png" />

    <link rel="stylesheet" href="/assets/css/style.css" />

    <style>
      /* Editorial Blog Layout - Fixed TOC Positioning */
      html {
        scroll-behavior: smooth;
      }

      body {
        background: rgb(15, 15, 20);
        color: rgb(200, 200, 210);
      }

      /* Main Container - Centered Content */
      .editorial-container {
        max-width: 1100px;
        margin: 0 auto;
        padding: 9rem 2rem 4rem 2rem;
        position: relative;
      }

      /* Article Typography */
      .editorial-article {
        font-size: 1.1875rem;
        line-height: 1.8;
        color: rgb(200, 200, 210);
      }

      .editorial-article h1 {
        font-size: 3rem;
        font-weight: 700;
        line-height: 1.2;
        margin-bottom: 2.5rem;
        color: rgb(255, 255, 255);
        font-family: 'SF Pro Display', 'Inter', sans-serif;
        letter-spacing: -0.02em;
      }

      .editorial-article h2 {
        font-size: 2.125rem;
        font-weight: 600;
        margin-top: 3.5rem;
        margin-bottom: 1.5rem;
        color: rgb(255, 255, 255);
        font-family: 'SF Pro Display', 'Inter', sans-serif;
        letter-spacing: -0.01em;
      }

      .editorial-article h3 {
        font-size: 1.625rem;
        font-weight: 600;
        margin-top: 2.5rem;
        margin-bottom: 1rem;
        color: rgb(255, 255, 255);
        font-family: 'SF Pro Display', 'Inter', sans-serif;
      }

      .editorial-article p {
        margin-bottom: 1.75rem;
        font-size: 1.1875rem;
      }

      .editorial-article ul,
      .editorial-article ol {
        margin-bottom: 1.75rem;
        padding-left: 2rem;
      }

      .editorial-article li {
        margin-bottom: 0.75rem;
        font-size: 1.1875rem;
      }

      .editorial-article strong {
        color: rgb(255, 255, 255);
        font-weight: 600;
      }

      .editorial-article a {
        color: rgb(101, 228, 143);
        text-decoration: none;
        transition: all 0.2s;
        border-bottom: 1px solid rgba(101, 228, 143, 0.3);
      }

      .editorial-article a:hover {
        color: rgb(130, 255, 172);
        border-bottom-color: rgb(130, 255, 172);
      }

      /* Author Byline */
      .author-byline {
        margin-bottom: 3rem;
        padding-bottom: 2rem;
        border-bottom: 1px solid rgba(50, 50, 60, 0.3);
      }

      .author-avatar {
        width: 3.5rem;
        height: 3.5rem;
        border-radius: 50%;
        background: rgba(30, 30, 35, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        border: 2px solid rgba(101, 228, 143, 0.2);
      }

      .author-avatar span {
        color: rgb(101, 228, 143);
        font-weight: 700;
        font-size: 1.25rem;
      }

      .author-name {
        color: rgb(255, 255, 255);
        font-weight: 600;
        font-size: 1rem;
      }

      .author-meta {
        color: rgb(150, 150, 160);
        font-size: 0.875rem;
        margin-top: 0.25rem;
      }

      /* Fixed TOC Sidebar */
      .toc-sidebar {
        position: fixed;
        left: 2rem;
        top: 7rem;
        width: 280px;
        max-height: calc(100vh - 10rem);
        overflow-y: auto;
        padding: 1.5rem;
        background: rgba(25, 25, 30, 0.8);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(50, 50, 60, 0.3);
        border-radius: 1rem;
        transition: all 0.3s ease;
      }

      .toc-sidebar::-webkit-scrollbar {
        width: 4px;
      }

      .toc-sidebar::-webkit-scrollbar-track {
        background: rgba(30, 30, 35, 0.3);
        border-radius: 2px;
      }

      .toc-sidebar::-webkit-scrollbar-thumb {
        background: rgba(101, 228, 143, 0.3);
        border-radius: 2px;
      }

      .toc-sidebar::-webkit-scrollbar-thumb:hover {
        background: rgba(101, 228, 143, 0.5);
      }

      .toc-title {
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        color: rgb(150, 150, 160);
        margin-bottom: 1rem;
      }

      .toc-link {
        display: block;
        padding: 0.5rem 0;
        color: rgb(185, 185, 190);
        font-size: 0.875rem;
        text-decoration: none;
        transition: all 0.2s;
        border-left: 2px solid transparent;
        padding-left: 0.75rem;
        margin-left: -0.75rem;
      }

      .toc-link:hover {
        color: rgb(101, 228, 143);
        border-left-color: rgb(101, 228, 143);
      }

      .toc-link.active {
        color: rgb(101, 228, 143);
        border-left-color: rgb(101, 228, 143);
        font-weight: 500;
      }

      /* CTA Box */
      .cta-box {
        margin: 3rem 0;
        padding: 2rem;
        background: linear-gradient(135deg, rgba(101, 228, 143, 0.08), rgba(30, 30, 35, 0.6));
        border: 2px solid rgba(101, 228, 143, 0.25);
        border-radius: 1rem;
      }

      .cta-box h3 {
        color: rgb(255, 255, 255);
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 1rem;
        margin-top: 0;
      }

      .cta-box p {
        color: rgb(200, 200, 210);
        margin-bottom: 1.5rem;
      }

      .cta-box a {
        display: inline-block;
        padding: 0.875rem 2rem;
        background: rgb(101, 228, 143);
        color: rgb(15, 15, 20);
        font-weight: 600;
        border-radius: 0.5rem;
        text-decoration: none;
        border: none;
        transition: all 0.2s ease;
      }

      .cta-box a:hover {
        background: rgb(130, 255, 172);
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(101, 228, 143, 0.3);
      }

      /* Author Bio Box */
      .author-bio-box {
        margin-top: 4rem;
        padding: 2rem;
        background: rgba(30, 30, 35, 0.4);
        border: 1px solid rgba(50, 50, 60, 0.3);
        border-radius: 1rem;
      }

      .author-bio-box h3 {
        color: rgb(255, 255, 255);
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 1rem;
      }

      .author-bio-box p {
        color: rgb(185, 185, 190);
        font-size: 0.95rem;
        line-height: 1.6;
        margin-bottom: 1rem;
      }

      .author-bio-box a {
        color: rgb(101, 228, 143);
        text-decoration: none;
        font-size: 0.9rem;
        transition: all 0.2s;
      }

      .author-bio-box a:hover {
        text-decoration: underline;
      }

      /* Related Posts Section */
      .related-posts-section {
        width: 100%;
        padding: 4rem 1.5rem;
        background: rgba(15, 15, 20, 0.8);
        border-top: 1px solid rgba(50, 50, 60, 0.3);
        margin-top: 4rem;
      }

      .related-posts-container {
        max-width: 1200px;
        margin: 0 auto;
      }

      .related-posts-section h3 {
        font-size: 1.75rem;
        font-weight: 600;
        margin-bottom: 2.5rem;
        color: rgb(255, 255, 255);
        text-align: center;
      }

      .related-posts-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
      }

      .related-post-card {
        padding: 1.5rem;
        background: rgba(30, 30, 35, 0.5);
        border: 1px solid rgba(50, 50, 60, 0.3);
        border-radius: 0.75rem;
        text-decoration: none;
        transition: all 0.3s ease;
      }

      .related-post-card:hover {
        border-color: rgba(101, 228, 143, 0.5);
        transform: translateY(-3px);
        box-shadow: 0 12px 24px rgba(0, 0, 0, 0.3);
      }

      .related-post-card h4 {
        font-size: 1.125rem;
        font-weight: 600;
        color: rgb(255, 255, 255);
        margin-bottom: 0.75rem;
        line-height: 1.4;
      }

      .related-post-card p {
        font-size: 0.9rem;
        color: rgb(150, 150, 160);
        margin-bottom: 0;
        line-height: 1.5;
      }

      /* Responsive Design */
      @media (max-width: 1400px) {
        .toc-sidebar {
          width: 240px;
        }
      }

      @media (max-width: 1400px) {
        .editorial-container {
          max-width: 900px;
        }
      }

      @media (max-width: 1200px) {
        .toc-sidebar {
          display: none;
        }

        .editorial-container {
          max-width: 800px;
        }
      }

      @media (max-width: 768px) {
        .editorial-container {
          padding: 4rem 1.5rem 3rem 1.5rem;
        }

        .editorial-article h1 {
          font-size: 2.5rem;
        }

        .editorial-article h2 {
          font-size: 1.875rem;
        }

        .editorial-article h3 {
          font-size: 1.5rem;
        }

        .editorial-article {
          font-size: 1.125rem;
        }

        .editorial-article p,
        .editorial-article li {
          font-size: 1.125rem;
        }

        .related-posts-grid {
          grid-template-columns: 1fr;
        }
      }
    </style>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "ProfessionalService",
      "name": "Troy Assoignon - Positioning Expert",
      "description": "Strategic brand positioning consultant helping luxury brands and executives capture premium market positioning through data-driven positioning strategy.",
      "url": "https://www.troyassoignon.com",
      "logo": "https://www.troyassoignon.com/favicon.svg",
      "image": "https://www.troyassoignon.com/og-image.png",
      "address": {
        "@type": "PostalAddress",
        "addressCountry": "CA"
      },
      "founder": {
        "@type": "Person",
        "name": "Troy Assoignon",
        "jobTitle": "Positioning Expert",
        "description": "Positioning expert with $62.7M in documented client results. Creator of the Strategic Positioning Advantage™ framework.",
        "url": "https://www.troyassoignon.com",
        "knowsAbout": [
          "Brand Positioning",
          "Strategic Positioning",
          "Luxury Brand Strategy",
          "Investor Positioning",
          "Premium Pricing Strategy",
          "Market Differentiation"
        ]
      }
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Article",
      "headline": "In-House Positioning vs. Expert-Led: The Complete ROI Analysis [2025]",
      "description": "Compare in-house positioning vs. expert-led approaches with complete ROI analysis. Discover true costs, timelines, and when each delivers maximum value.",
      "image": "https://www.troyassoignon.com/og-image.png",
      "author": {
        "@type": "Person",
        "name": "Troy Assoignon",
        "url": "https://www.troyassoignon.com",
        "jobTitle": "Positioning Expert",
        "description": "Positioning expert with $62.7M in documented client results"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Troy Assoignon",
        "logo": {
          "@type": "ImageObject",
          "url": "https://www.troyassoignon.com/favicon.svg"
        }
      },
      "datePublished": "2025-11-01",
      "dateModified": "2025-11-01",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://www.troyassoignon.com/blog/in-house-vs-expert-positioning"
      },
      "keywords": ["in-house positioning", "positioning expert", "ROI analysis", "positioning costs", "strategic positioning", "brand positioning comparison"]
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Troy Assoignon",
      "jobTitle": "Positioning Expert",
      "url": "https://www.troyassoignon.com",
      "knowsAbout": [
        "Brand Positioning",
        "Strategic Positioning",
        "Luxury Brand Strategy",
        "Investor Positioning",
        "Premium Pricing Strategy",
        "Market Differentiation"
      ]
    }
    </script>
  </head>

  <body class="bg-black text-luxury-300 font-sans antialiased">
    <header id="navbar" class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 px-6 md:px-12 py-4 md:py-6 bg-black/80 backdrop-blur-md shadow-md">
      <div class="max-w-7xl mx-auto flex items-center justify-between">
        <a href="/" class="text-xl font-display font-bold tracking-tight flex items-center">
          <span class="luxury-gradient">TROY ASSOIGNON</span>
          <span class="bg-accent-green h-1.5 w-1.5 rounded-full ml-1 mt-1"></span>
        </a>

        <nav class="hidden md:flex items-center space-x-8">
          <a href="/" class="back-button" aria-label="Return to home page">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            <span>Back to Home</span>
          </a>
          <div class="relative group">
            <a href="/#services" class="nav-item flex items-center">
              Services
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ml-1 w-4 h-4 transition-transform duration-200 group-hover:rotate-180">
                <polyline points="6 9 12 15 18 9"></polyline>
              </svg>
            </a>

            <!-- Services dropdown -->
            <div id="services-dropdown" class="absolute top-full left-0 mt-1 w-64 bg-black/90 backdrop-blur-lg border border-luxury-800/30 rounded-xl overflow-hidden transition-all duration-300 ease-out transform opacity-0 translate-y-2 pointer-events-none">
              <div class="py-2">
                <a href="/services/strategic-brand-positioning.html" class="block px-4 py-2 text-sm text-luxury-300 hover:text-white hover:bg-accent-green/10 transition-colors">
                  Strategic Brand Positioning
                </a>
                <a href="/services/authority-thought-leadership.html" class="block px-4 py-2 text-sm text-luxury-300 hover:text-white hover:bg-accent-green/10 transition-colors">
                  Authority & Thought Leadership
                </a>
                <a href="/services/investor-ready-positioning.html" class="block px-4 py-2 text-sm text-luxury-300 hover:text-white hover:bg-accent-green/10 transition-colors">
                  Investor-Ready Positioning
                </a>
                <a href="/services/premium-pricing-offers.html" class="block px-4 py-2 text-sm text-luxury-300 hover:text-white hover:bg-accent-green/10 transition-colors">
                  Premium Pricing & Offers
                </a>
                <a href="/services/positioning-diagnostics.html" class="block px-4 py-2 text-sm text-luxury-300 hover:text-white hover:bg-accent-green/10 transition-colors">
                  Positioning Diagnostics
                </a>
                <a href="/services/fractional-cmo-cpo.html" class="block px-4 py-2 text-sm text-luxury-300 hover:text-white hover:bg-accent-green/10 transition-colors">
                  Fractional CMO/CPO
                </a>
              </div>
            </div>
          </div>
          <a href="/#about" class="nav-item">About</a>
          <a href="/#process" class="nav-item">Process</a>
          <a href="/blog.html" class="nav-item">Blog</a>
          <a href="/faq.html" class="nav-item">FAQ</a>


          <a href="/#contact" class="button-primary">Get in Touch</a>
        </nav>

        <div class="md:hidden flex items-center space-x-4">
          <!-- Mobile back button -->
          <a href="/" class="back-button" aria-label="Return to home page">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            <span class="sr-only">Back to Home</span>
          </a>

          <button
            id="mobile-menu-button"
            class="text-luxury-300 hover:text-white transition-colors"
            aria-label="Toggle menu"
          >
            <svg id="menu-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="4" y1="12" x2="20" y2="12"></line>
              <line x1="4" y1="6" x2="20" y2="6"></line>
              <line x1="4" y1="18" x2="20" y2="18"></line>
            </svg>
            <svg id="close-icon" class="hidden" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M18 6L6 18M6 6l12 12"></path>
            </svg>
          </button>
        </div>
      </div>

      <!-- Mobile Menu -->
      <div id="mobile-menu" class="fixed inset-0 bg-black/95 backdrop-blur-xl z-40 flex flex-col items-center justify-center space-y-8 pt-20 transition-all duration-500 ease-in-out transform opacity-0 translate-x-full pointer-events-none">
        <a href="/" class="nav-item text-xl mobile-nav-item">Home</a>
        <a href="/#services" class="nav-item text-xl mobile-nav-item">Services</a>
        <a href="/#about" class="nav-item text-xl mobile-nav-item">About</a>
        <a href="/#process" class="nav-item text-xl mobile-nav-item">Process</a>
        <a href="/blog.html" class="nav-item text-xl mobile-nav-item">Blog</a>
        <a href="/faq.html" class="nav-item text-xl mobile-nav-item">FAQ</a>
        <a href="/#contact" class="button-primary text-xl mt-4">Get in Touch</a>
      </div>
    </header>

    <!-- Fixed TOC Sidebar (Desktop Only) -->
    <aside class="toc-sidebar">
      <div class="toc-title">On this page</div>
      <a href="#true-cost-analysis" class="toc-link">The True Cost Analysis</a>
      <a href="#when-diy-works" class="toc-link">When DIY Positioning Works (Rare Scenarios)</a>
      <a href="#when-expert-led-delivers" class="toc-link">When Expert-Led Delivers ROI (Most Growth-Stage...</a>
      <a href="#risk-comparison" class="toc-link">Risk Comparison: What Failure Looks Like</a>
      <a href="#decision-framework" class="toc-link">Decision Framework: 7 Questions to Determine Yo...</a>
      <a href="#real-cost-examples" class="toc-link">Cost Structure Comparison: Framework for Analysis</a>
      <a href="#conclusion" class="toc-link">Conclusion: ROI Favors Expert-Led for Most Comp...</a>
    </aside>

    <!-- Main Content Container -->
    <div class="editorial-container">
      <article class="editorial-article">
        <!-- Author Byline -->
        <div class="author-byline">
          <div class="flex items-center gap-4">
            <div class="author-avatar">
              <span>TA</span>
            </div>
            <div>
              <div class="author-name">Troy Assoignon</div>
              <div class="author-meta">November 1, 2025 • 11 min read</div>
            </div>
          </div>
        </div>

        <!-- Article Title -->
        <h1>In-House Positioning vs. Expert-Led: The Complete ROI Analysis</h1>

        <!-- Article Content -->


        <!-- Author Bio Box -->
    <div class="author-bio-box">
      <div class="flex gap-4 items-start">
        <div class="w-16 h-16 rounded-full bg-luxury-800 flex items-center justify-center flex-shrink-0">
          <span class="text-accent-green font-bold text-2xl">TA</span>
        </div>
        <div>
          <h3>About Troy Assoignon</h3>
          <p>Troy is a positioning expert with $62.7M in documented client results. He created the Strategic Positioning Advantage™ framework and placed 2nd in the ElevenLabs international hackathon.</p>
          <div class="flex gap-4">
            <a href="/#about">Learn more about Troy</a>
            <a href="https://linkedin.com/in/troyassoignon" target="_blank">Connect on LinkedIn</a>
          </div>
        </div>
      </div>
    </div>
      </article>
    </div>

    

    <footer class="py-12 px-6 bg-black border-t border-luxury-800/20">
      <div class="max-w-7xl mx-auto">
        <div class="flex flex-col md:flex-row justify-between items-center">
          <div class="mb-6 md:mb-0">
            <a href="/" class="text-xl font-display font-bold tracking-tight flex items-center">
              <span class="luxury-gradient">TROY ASSOIGNON</span>
              <span class="bg-accent-green h-1.5 w-1.5 rounded-full ml-1 mt-1"></span>
            </a>
            <p class="text-sm text-luxury-500 mt-2">Strategic Brand Positioning</p>
          </div>

          <nav class="flex flex-wrap justify-center md:justify-end gap-x-8 gap-y-4 mb-8 md:mb-0">
            <a href="/#services" class="text-sm text-luxury-400 hover:text-luxury-200 transition-colors">Services</a>
            <a href="/#about" class="text-sm text-luxury-400 hover:text-luxury-200 transition-colors">About</a>
            <a href="/#process" class="text-sm text-luxury-400 hover:text-luxury-200 transition-colors">Process</a>
            <a href="/blog.html" class="text-sm text-luxury-400 hover:text-luxury-200 transition-colors">Blog</a>
            <a href="/#contact" class="text-sm text-luxury-400 hover:text-luxury-200 transition-colors">Contact</a>
          </nav>
        </div>

        <div class="mt-8 pt-8 border-t border-luxury-800/20 text-center">
          <p class="text-sm text-luxury-500">&copy; 2025 Troy Assoignon. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <script type="module" src="/src/main.js"></script>

    <!-- TOC Scroll Tracking -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const tocLinks = document.querySelectorAll('.toc-link');
        const sections = Array.from(document.querySelectorAll('h2[id]')); // Only track H2 sections

        function setActiveLink() {
          // Get current scroll position with offset for header
          const scrollPosition = window.scrollY + 200;

          let currentSection = null;

          // Find the section that's currently in view
          // Start from the bottom and work up to find the last section that's above the scroll position
          for (let i = sections.length - 1; i >= 0; i--) {
            const section = sections[i];
            const sectionTop = section.offsetTop;

            if (scrollPosition >= sectionTop - 100) {
              currentSection = section.getAttribute('id');
              break;
            }
          }

          // If we're at the very top, highlight the first section
          if (!currentSection && sections.length > 0) {
            currentSection = sections[0].getAttribute('id');
          }

          // Update active states
          tocLinks.forEach(link => {
            const href = link.getAttribute('href');
            if (href === '#' + currentSection) {
              link.classList.add('active');
            } else {
              link.classList.remove('active');
            }
          });
        }

        // Set initial active state
        setTimeout(setActiveLink, 100);

        // Update on scroll with throttle for performance
        let ticking = false;
        window.addEventListener('scroll', function() {
          if (!ticking) {
            window.requestAnimationFrame(function() {
              setActiveLink();
              ticking = false;
            });
            ticking = true;
          }
        });

        // Smooth scroll when clicking TOC links
        tocLinks.forEach(link => {
          link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);
            const targetSection = document.getElementById(targetId);

            if (targetSection) {
              const offsetTop = targetSection.offsetTop - 120;
              window.scrollTo({
                top: offsetTop,
                behavior: 'smooth'
              });

              // Immediately set active after clicking
              setTimeout(setActiveLink, 100);
            }
          });
        });
      });
    </script>
  </body>
</html>
